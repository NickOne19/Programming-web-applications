// –ñ–¥—ë–º, –ø–æ–∫–∞ –≤–µ—Å—å HTML-–¥–æ–∫—É–º–µ–Ω—Ç –∑–∞–≥—Ä—É–∑–∏—Ç—Å—è, –∑–∞—Ç–µ–º –≤—ã–ø–æ–ª–Ω—è–µ–º –∫–æ–¥
document.addEventListener('DOMContentLoaded', () => {
    
    // –ü–æ–ª—É—á–∞–µ–º —Ñ–æ—Ä–º—É –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Å—Ç—É–¥–µ–Ω—Ç–∞
    const studentForm = document.getElementById('studentForm');
    
    // –ü–æ–ª—É—á–∞–µ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è —Å–ø–∏—Å–∫–∞ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤
    const studentList = document.getElementById('studentList');
    
    // –ó–∞–≥—Ä—É–∂–∞–µ–º —Å–ø–∏—Å–æ–∫ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ –∏–∑ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ –∏–ª–∏ —Å–æ–∑–¥–∞–µ–º –ø—É—Å—Ç–æ–π –º–∞—Å—Å–∏–≤
    let students = JSON.parse(localStorage.getItem('students')) || [];

    // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ —Å–æ–±—ã—Ç–∏—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ñ–æ—Ä–º—ã
    studentForm.addEventListener('submit', (event) => {
        event.preventDefault(); // –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ–º –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫—É —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        addStudent(); // –í—ã–∑—ã–≤–∞–µ–º —Ñ—É–Ω–∫—Ü–∏—é –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Å—Ç—É–¥–µ–Ω—Ç–∞
    });

    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Å—Ç—É–¥–µ–Ω—Ç–∞
    function addStudent() {
        // –ü–æ–ª—É—á–∞–µ–º –≤–≤–µ–¥—ë–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –∏ —É–±–∏—Ä–∞–µ–º –ø—Ä–æ–±–µ–ª—ã –ø–æ –∫—Ä–∞—è–º
        const faculty = document.getElementById('faculty').value.trim();
        const group = document.getElementById('group').value.trim();
        const name = document.getElementById('name').value.trim();

        // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –≤—Å–µ –ø–æ–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω—ã
        if (!faculty || !group || !name) return;

        // –°–æ–∑–¥–∞—ë–º –æ–±—ä–µ–∫—Ç —Å—Ç—É–¥–µ–Ω—Ç–∞ —Å —É–Ω–∏–∫–∞–ª—å–Ω—ã–º –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–æ–º
        const student = { id: Date.now(), faculty, group, name };
        
        // –î–æ–±–∞–≤–ª—è–µ–º —Å—Ç—É–¥–µ–Ω—Ç–∞ –≤ –º–∞—Å—Å–∏–≤
        students.push(student);
        
        // –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–∞–Ω–Ω—ã–µ –∏ –æ–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
        saveAndRender();
        
        // –û—á–∏—â–∞–µ–º —Ñ–æ—Ä–º—É
        studentForm.reset();
    }

    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å–ø–∏—Å–∫–∞ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤
    function renderStudentList() {
        // –û—á–∏—â–∞–µ–º —Å–ø–∏—Å–æ–∫ –ø–µ—Ä–µ–¥ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ–º
        studentList.innerHTML = '';

        // –û–±—ä–µ–∫—Ç –¥–ª—è –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ –ø–æ —Ñ–∞–∫—É–ª—å—Ç–µ—Ç—É –∏ –≥—Ä—É–ø–ø–µ
        const groupedStudents = {};

        // –ì—Ä—É–ø–ø–∏—Ä—É–µ–º —Å—Ç—É–¥–µ–Ω—Ç–æ–≤
        students.forEach(student => {
            const key = `${student.faculty} - ${student.group}`; // –°–æ–∑–¥–∞—ë–º –∫–ª—é—á –¥–ª—è –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏
            if (!groupedStudents[key]) groupedStudents[key] = []; // –°–æ–∑–¥–∞—ë–º –º–∞—Å—Å–∏–≤, –µ—Å–ª–∏ –µ–≥–æ –µ—â—ë –Ω–µ—Ç
            groupedStudents[key].push(student); // –î–æ–±–∞–≤–ª—è–µ–º —Å—Ç—É–¥–µ–Ω—Ç–∞ –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â—É—é –≥—Ä—É–ø–ø—É
        });

        // –°–æ–∑–¥–∞—ë–º HTML-—Ä–∞–∑–º–µ—Ç–∫—É –¥–ª—è –∫–∞–∂–¥–æ–π –≥—Ä—É–ø–ø—ã
        Object.entries(groupedStudents).forEach(([group, students]) => {
            const groupDiv = document.createElement('div'); // –°–æ–∑–¥–∞—ë–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –≥—Ä—É–ø–ø—ã
            groupDiv.classList.add('group-container'); // –î–æ–±–∞–≤–ª—è–µ–º –∫–ª–∞—Å—Å –¥–ª—è —Å—Ç–∏–ª–∏–∑–∞—Ü–∏–∏
            groupDiv.innerHTML = `<h3>${group}</h3>`; // –ó–∞–≥–æ–ª–æ–≤–æ–∫ –≥—Ä—É–ø–ø—ã

            // –î–æ–±–∞–≤–ª—è–µ–º —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ –≤ –≥—Ä—É–ø–ø—É
            students.forEach(student => {
                const studentDiv = document.createElement('div'); // –°–æ–∑–¥–∞—ë–º —ç–ª–µ–º–µ–Ω—Ç –¥–ª—è —Å—Ç—É–¥–µ–Ω—Ç–∞
                studentDiv.classList.add('student-item'); // –î–æ–±–∞–≤–ª—è–µ–º –∫–ª–∞—Å—Å –¥–ª—è —Å—Ç–∏–ª–∏–∑–∞—Ü–∏–∏
                studentDiv.innerHTML = `
                    <span>${student.name}</span>
                    <button onclick="editStudent(${student.id})">‚úèÔ∏è</button>
                    <button onclick="deleteStudent(${student.id})">üóëÔ∏è</button>
                `; // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º –∏–º—è —Å—Ç—É–¥–µ–Ω—Ç–∞ –∏ –∫–Ω–æ–ø–∫–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è/—É–¥–∞–ª–µ–Ω–∏—è
                
                groupDiv.appendChild(studentDiv); // –î–æ–±–∞–≤–ª—è–µ–º —Å—Ç—É–¥–µ–Ω—Ç–∞ –≤ –≥—Ä—É–ø–ø—É
            });

            studentList.appendChild(groupDiv); // –î–æ–±–∞–≤–ª—è–µ–º –≥—Ä—É–ø–ø—É –≤ —Å–ø–∏—Å–æ–∫ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤
        });
    }

    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å—Ç—É–¥–µ–Ω—Ç–∞
    window.editStudent = function(id) {
        const student = students.find(s => s.id === id); // –ù–∞—Ö–æ–¥–∏–º —Å—Ç—É–¥–µ–Ω—Ç–∞ –ø–æ ID
        if (student) {
            // –ó–∞–ø–æ–ª–Ω—è–µ–º —Ñ–æ—Ä–º—É –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ —Å—Ç—É–¥–µ–Ω—Ç–∞
            document.getElementById('faculty').value = student.faculty;
            document.getElementById('group').value = student.group;
            document.getElementById('name').value = student.name;

            // –£–¥–∞–ª—è–µ–º —Å—Ç—É–¥–µ–Ω—Ç–∞ –∏–∑ –º–∞—Å—Å–∏–≤–∞
            students = students.filter(s => s.id !== id);
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è –∏ –æ–±–Ω–æ–≤–ª—è–µ–º —Å–ø–∏—Å–æ–∫
            saveAndRender();
        }
    }

    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è —Å—Ç—É–¥–µ–Ω—Ç–∞
    window.deleteStudent = function(id) {
        students = students.filter(s => s.id !== id); // –§–∏–ª—å—Ç—Ä—É–µ–º –º–∞—Å—Å–∏–≤, —É–¥–∞–ª—è—è —Å—Ç—É–¥–µ–Ω—Ç–∞ –ø–æ ID
        saveAndRender(); // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è –∏ –æ–±–Ω–æ–≤–ª—è–µ–º —Å–ø–∏—Å–æ–∫
    }

    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –≤ –ª–æ–∫–∞–ª—å–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å–ø–∏—Å–∫–∞ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤
    function saveAndRender() {
        localStorage.setItem('students', JSON.stringify(students)); // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Å–ø–∏—Å–æ–∫ –≤ –ª–æ–∫–∞–ª—å–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ
        renderStudentList(); // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤
    }

    renderStudentList(); // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º —Å–ø–∏—Å–æ–∫ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
});
